{"remainingRequest":"/home/beanyon/Desktop/workspace/time-partner/node_modules/babel-loader/lib/index.js!/home/beanyon/Desktop/workspace/time-partner/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/beanyon/Desktop/workspace/time-partner/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/beanyon/Desktop/workspace/time-partner/src/components/StringUtil.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/beanyon/Desktop/workspace/time-partner/src/components/StringUtil.vue","mtime":1545395912470},{"path":"/home/beanyon/Desktop/workspace/time-partner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/beanyon/Desktop/workspace/time-partner/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/beanyon/Desktop/workspace/time-partner/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/beanyon/Desktop/workspace/time-partner/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'Home',\n  data: function data() {\n    return {\n      // 今日数据\n      today: {\n        date: '2018年12月21日',\n        slogan: 'Life is a struggle!',\n        minutesSum: 748\n      },\n      // 时间卡片数组\n      timeCards: []\n    };\n  },\n  methods: {\n    /**\n     * 初始化\n     */\n    init: function init() {},\n\n    /**\n     * 创建时间卡片\n     */\n    createTimeCard: function createTimeCard() {\n      var _this = this;\n\n      this.$http.get(this.BASE_API + '/create-time-card?user_id=' + this.userInfo.id).then(function (response) {\n        if (response.body.result) {\n          _this.getTodayTimeCard();\n\n          _this.$toast.success(response.body.message);\n        } else {\n          _this.$toast.error(response.body.message);\n        }\n      });\n    },\n\n    /**\n     * 为时间卡片添加时间段\n     */\n    createTimeSpan: function createTimeSpan(cardIndex) {\n      this.timeCards[cardIndex].timeSpans.push({\n        id: -1,\n        startTime: 0,\n        endTime: 0\n      });\n    },\n\n    /**\n     * 获取今天的时间卡片\n     */\n    getTodayTimeCard: function getTodayTimeCard() {\n      var _this2 = this;\n\n      this.$http.get(this.BASE_API + '/get-today-time-card?user_id=' + this.userInfo.id).then(function (response) {\n        if (response.body.result) {\n          _this2.timeCards = response.body.data;\n        }\n      });\n    },\n\n    /**\n     * 事件选择器值发生变化的监听器，用于创建TimeCard的TimeSpan\n     */\n    onDatePickerChange: function onDatePickerChange(cardIndex, spanIndex, type) {\n      var _this3 = this;\n\n      var startTime = this.timeCards[cardIndex].timeSpans[spanIndex].startTime;\n      var endTime = this.timeCards[cardIndex].timeSpans[spanIndex].endTime;\n      var cardId = this.timeCards[cardIndex].id;\n      var spanId = this.timeCards[cardIndex].timeSpans[spanIndex].id;\n\n      if (startTime != 0 && endTime != 0) {\n        if (endTime - startTime > 0) {\n          if (spanId == -1) {\n            // 创建\n            this.$http.get(this.BASE_API + '/create-time-span?card_id=' + cardId + '&start_time=' + startTime.getTime() + '&end_time=' + endTime.getTime()).then(function (response) {\n              if (response.body.result) {\n                _this3.getTodayTimeCard();\n\n                _this3.$toast.success(response.body.message);\n              } else {\n                _this3.$toast.error(response.body.message);\n              }\n            });\n          } else {\n            //更新\n            this.$http.get(this.BASE_API + '/update-time-span?card_id=' + cardId + '&span_id=' + spanId + '&start_time=' + startTime.getTime() + '&end_time=' + endTime.getTime()).then(function (response) {\n              if (response.body.result) {\n                _this3.getTodayTimeCard();\n\n                _this3.$toast.success(response.body.message);\n              } else {\n                _this3.$toast.error(response.body.message);\n              }\n            });\n          }\n        } else {\n          this.$toast.error('结束时间不能小于开始时间，请重新输入');\n        }\n      }\n    },\n\n    /**\n     * 更新TimeCard的activity\n     */\n    updateCardActivity: function updateCardActivity(cardIndex) {\n      var _this4 = this;\n\n      var cardId = this.timeCards[cardIndex].id;\n      var activity = this.timeCards[cardIndex].activity.trim();\n\n      if (activity.length > 0) {\n        this.$http.get(this.BASE_API + '/update-card-activity?card_id=' + cardId + '&activity=' + activity).then(function (response) {\n          if (response.body.result) {\n            _this4.$toast.success(response.body.message);\n          } else {\n            _this4.$toast.error(response.body.message);\n          }\n        });\n      }\n    },\n\n    /**\n     * 删除时间卡片\n     */\n    deleteTimeCard: function deleteTimeCard(cardIndex) {\n      var _this5 = this;\n\n      var cardId = this.timeCards[cardIndex].id;\n      this.$http.get(this.BASE_API + '/delete-time-card?card_id=' + cardId).then(function (response) {\n        if (response.body.result) {\n          _this5.getTodayTimeCard();\n\n          _this5.$toast.success(response.body.message);\n        } else {\n          _this5.$toast.error(response.body.message);\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n    this.getTodayTimeCard();\n  }\n};",{"version":3,"sources":["StringUtil.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <mu-container>\n    <!-- TitleBar -->\n    <mu-appbar style=\"width: 100%;\" color=\"primary\">\n      <mu-button icon slot=\"left\">\n        <mu-icon value=\"menu\"></mu-icon>\n      </mu-button>\n      时间卡片\n      <mu-button icon slot=\"right\" @click=\"createTimeCard()\">\n        <mu-icon value=\"add\"></mu-icon>\n      </mu-button>\n    </mu-appbar>\n    <!-- Main Content -->\n    <div style=\"width: 100%; background: #fff; padding: 18px;\">\n      <mu-card class=\"card-header\">\n        <mu-card-header :title=\"today.date\" :sub-title=\"today.slogan\">\n          <mu-avatar slot=\"avatar\">\n            <img src=\"../assets/avatar.jpg\">\n          </mu-avatar>\n        </mu-card-header>\n        <mu-paper class=\"demo-paper card-header-panel\" :z-depth=\"1\" :circle=\"true\">\n          {{today.minutesSum || 0}} min\n        </mu-paper>\n      </mu-card>\n      <mu-card class=\"time-card\" v-for=\"(timeCard, cardIndex) in timeCards\" :key=\"cardIndex\">\n        <mu-button icon class=\"delete-time-card\" @click=\"deleteTimeCard(cardIndex)\">\n          <mu-icon value=\"clear\"></mu-icon>\n        </mu-button>\n        <mu-card-text>\n          <mu-form :model=\"timeCard\" class=\"mu-demo-form\">\n            <mu-form-item prop=\"activity\">\n              <mu-text-field placeholder='请输入活动名称，如‘学习英语’' v-model=\"timeCard.activity\" @change=\"updateCardActivity(cardIndex)\"></mu-text-field>\n            </mu-form-item>\n            <mu-flex class=\"flex-wrapper\" align-items=\"center\" v-for=\"(timeSpan, spanIndex) in timeCard.timeSpans\" :key=\"spanIndex\">\n              <mu-flex class=\"flex-demo\" justify-content=\"center\" fill>\n                <mu-date-input placeholder=\"开始时间\" v-model=\"timeSpan.startTime\" type=\"time\" view-type=\"list\" clock-type=\"24hr\" @change=\"onDatePickerChange(cardIndex, spanIndex, 'start')\"></mu-date-input>\n              </mu-flex>\n              <mu-flex class=\"flex-demo\" justify-content=\"center\" fill>\n                <mu-date-input placeholder=\"结束时间\" v-model=\"timeSpan.endTime\" type=\"time\" view-type=\"list\" clock-type=\"24hr\" @change=\"onDatePickerChange(cardIndex, spanIndex, 'end')\"></mu-date-input>\n              </mu-flex>\n            </mu-flex>\n            <mu-button full-width color=\"primary\" @click=\"createTimeSpan(cardIndex)\">\n              <mu-icon value=\"add\" left></mu-icon>\n              添加时间段\n            </mu-button>\n          </mu-form>\n        </mu-card-text>\n      </mu-card>\n    </div>\n    <!-- <router-link to=\"/sign-up\">\n      <mu-button full-width color=\"primary\">\n        <mu-icon value=\"add\" left></mu-icon>\n        注册\n      </mu-button>\n    </router-link> -->\n  </mu-container>\n</template>\n<script>\nexport default {\n  name: 'Home',\n  data() {\n    return {\n      // 今日数据\n      today: {\n        date: '2018年12月21日',\n        slogan: 'Life is a struggle!',\n        minutesSum: 748\n      },\n      // 时间卡片数组\n      timeCards: []\n    }\n  },\n  methods: {\n    /**\n     * 初始化\n     */\n    init() {\n\n    },\n\n    /**\n     * 创建时间卡片\n     */\n    createTimeCard() {\n      this.$http.get(this.BASE_API + '/create-time-card?user_id=' + this.userInfo.id).then(response => {\n        if (response.body.result) {\n          this.getTodayTimeCard()\n          this.$toast.success(response.body.message)\n        } else {\n          this.$toast.error(response.body.message)\n        }\n      })\n    },\n\n    /**\n     * 为时间卡片添加时间段\n     */\n    createTimeSpan(cardIndex) {\n      this.timeCards[cardIndex].timeSpans.push({\n        id: -1,\n        startTime: 0,\n        endTime: 0\n      })\n    },\n\n    /**\n     * 获取今天的时间卡片\n     */\n    getTodayTimeCard() {\n      this.$http.get(this.BASE_API + '/get-today-time-card?user_id=' + this.userInfo.id).then(response => {\n        if (response.body.result) {\n          this.timeCards = response.body.data\n        }\n      })\n    },\n\n    /**\n     * 事件选择器值发生变化的监听器，用于创建TimeCard的TimeSpan\n     */\n    onDatePickerChange(cardIndex, spanIndex, type) {\n      let startTime = this.timeCards[cardIndex].timeSpans[spanIndex].startTime\n      let endTime = this.timeCards[cardIndex].timeSpans[spanIndex].endTime\n      let cardId = this.timeCards[cardIndex].id\n      let spanId = this.timeCards[cardIndex].timeSpans[spanIndex].id\n\n      if(startTime != 0 && endTime != 0) {\n        if(endTime - startTime > 0) {\n          if(spanId == -1) {\n            // 创建\n            this.$http.get(this.BASE_API + '/create-time-span?card_id=' + cardId + '&start_time=' + startTime.getTime() + '&end_time=' + endTime.getTime()).then(response => {\n              if (response.body.result) {\n                this.getTodayTimeCard()\n                this.$toast.success(response.body.message)\n              } else {\n                this.$toast.error(response.body.message)\n              }\n            })\n          } else {\n            //更新\n            this.$http.get(this.BASE_API + '/update-time-span?card_id=' + cardId + '&span_id=' + spanId + '&start_time=' + startTime.getTime() + '&end_time=' + endTime.getTime()).then(response => {\n              if (response.body.result) {\n                this.getTodayTimeCard()\n                this.$toast.success(response.body.message)\n              } else {\n                this.$toast.error(response.body.message)\n              }\n            })\n          }\n          \n        } else {\n          this.$toast.error('结束时间不能小于开始时间，请重新输入')\n        }\n      }\n    },\n\n    /**\n     * 更新TimeCard的activity\n     */\n    updateCardActivity(cardIndex) {\n      let cardId = this.timeCards[cardIndex].id\n      let activity = this.timeCards[cardIndex].activity.trim()\n\n      if(activity.length > 0){\n        this.$http.get(this.BASE_API + '/update-card-activity?card_id=' + cardId + '&activity=' + activity).then(response => {\n          if (response.body.result) {\n            this.$toast.success(response.body.message)\n          } else {\n            this.$toast.error(response.body.message)\n          }\n        })\n      }\n    },\n\n    /**\n     * 删除时间卡片\n     */\n    deleteTimeCard(cardIndex) {\n      let cardId = this.timeCards[cardIndex].id\n\n      this.$http.get(this.BASE_API + '/delete-time-card?card_id=' + cardId).then(response => {\n        if (response.body.result) {\n          this.getTodayTimeCard()\n          this.$toast.success(response.body.message)\n        } else {\n          this.$toast.error(response.body.message)\n        }\n      })\n    }\n  },\n  mounted() {\n    this.init()\n    this.getTodayTimeCard()\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.card-header {\n  position: relative;\n}\n.card-header-panel {\n  position: absolute;\n  right: 26px;\n  top: 6px;\n  width: 64px;\n  height: 64px;\n  line-height: 64px;\n  text-align: center;\n  font-size: 16px;\n  font-weight: 400;\n  font-style: italic;\n}\n.time-card {\n  position: relative;\n  width: 100%;\n  margin: 12px auto;\n}\n.delete-time-card {\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  top: -6px;\n  right: -13px;\n  border: 1px solid #ccc;\n  background: #fff;\n}\n.flex-demo {\n  width: 0px;\n  text-align: center;\n}\n</style>\n"],"sourceRoot":"src/components"}]}